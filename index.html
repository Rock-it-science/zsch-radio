<!DOCTYPE html>
<meta charset="utf-8"/>
<html>
    <body>
      <iframe id='player' width="560" height="315" src=""></iframe>
      <p id='weather'>Weather here!</p>

      <script>

      //TODO Use promises to make this all run before getURL
      var weather_time = getWeather();
      function getWeather(){//Gets weather echoed from server.php
        var weatherRequest = new XMLHttpRequest();
        weatherRequest.onreadystatechange = function check(){
          if(weatherRequest.readyState == 4 && weatherRequest.status == 200){
            document.getElementById('weather').innerHTML = weatherRequest.responseText;
            console.log('weather set to: ' + weatherRequest.responseText);
            return weatherRequest.responseText;
          }
        };
        weatherRequest.open("GET", "getWeather.php", true);
        weatherRequest.send();
      }

      console.log(weather_time);
      getURL();
      function getURL(){//Gets URL echoed from server.php
        var urlRequest = new XMLHttpRequest();
        urlRequest.onreadystatechange = function check(){
          if(urlRequest.readyState == 4 && urlRequest.status == 200){
            document.getElementById('player').src = urlRequest.responseText;
            console.log('URL set to: ' + urlRequest.responseText);
          }
        };
        urlRequest.open("GET", "server.php?wt="+weather_time, true);
        urlRequest.send();
      }
      </script>
    </body>
</html>
